<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.13"/>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-powertip/1.2.0/jquery.powertip.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.smartmenus/1.0.1/jquery.smartmenus.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.smartmenus/1.0.1/addons/keyboard/jquery.smartmenus.keyboard.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.smartmenus/1.0.1/addons/bootstrap/jquery.smartmenus.bootstrap.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
        <title>MoMEMta: core/src/Math.cc Source File</title>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/solarized-light.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.smartmenus/1.0.1/addons/bootstrap/jquery.smartmenus.bootstrap.min.css">
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </button>
                    <a class="navbar-brand">MoMEMta </a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_90fd98a0ba30abf7a6068a44995d2d6b.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Math.cc</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  MoMEMta: a modular implementation of the Matrix Element Method</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  Copyright (C) 2016  Universite catholique de Louvain (UCL), Belgium</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *  it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  (at your option) any later version.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *  This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  GNU General Public License for more details.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Math_8h.html">momemta/Math.h</a>&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">   25</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> a, <span class="keyword">const</span> <span class="keywordtype">double</span> b, <span class="keyword">const</span> <span class="keywordtype">double</span> c, std::vector&lt;double&gt;&amp; roots,</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                    <span class="keywordtype">bool</span> verbose) {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (!a) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordflow">if</span> (!b) {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;No solution to equation &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; x^2 + &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; x + &quot;</span> &lt;&lt; c &lt;&lt; endl</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                 &lt;&lt; endl;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        roots.push_back(-c / b);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Solution of &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; x + &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; roots[0]</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;, test = &quot;</span> &lt;&lt; b * roots[0] + c &lt;&lt; endl</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                 &lt;&lt; endl;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> rho = <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(b) - 4. * a * c;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (rho &gt;= 0.) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (b == 0.) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            roots.push_back(sqrt(rho) / (2. * a));</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            roots.push_back(-sqrt(rho) / (2. * a));</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> x = -0.5 * (b + <a class="code" href="Math_8h.html#ae9bf9ca2a51a3c7bbcd32f3d29930684">sign</a>(b) * sqrt(rho));</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            roots.push_back(x / a);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            roots.push_back(c / x);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Solutions of &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; x^2 + &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; x + &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; roots.size(); i++)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; roots[i]</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;, test = &quot;</span> &lt;&lt; a * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(roots[i]) + b * roots[i] + c &lt;&lt; endl;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            cout &lt;&lt; endl;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;No real solutions to &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; x^2 + &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; x + &quot;</span> &lt;&lt; c &lt;&lt; endl &lt;&lt; endl;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="Math_8h.html#aa7d60d1f5a82d685d084c70662bf3980">   68</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="Math_8h.html#aa7d60d1f5a82d685d084c70662bf3980">solveCubic</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> a, <span class="keyword">const</span> <span class="keywordtype">double</span> b, <span class="keyword">const</span> <span class="keywordtype">double</span> c, <span class="keyword">const</span> <span class="keywordtype">double</span> d,</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                std::vector&lt;double&gt;&amp; roots, <span class="keywordtype">bool</span> verbose) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (a == 0)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a>(b, c, d, roots, verbose);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> an = b / a;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> bn = c / a;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> cn = d / a;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Q = <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(an) / 9. - bn / 3.;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> R = <a class="code" href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a>(an) / 27. - an * bn / 6. + cn / 2.;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(R) &lt; <a class="code" href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a>(Q)) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> theta = acos(R / sqrt(<a class="code" href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a>(Q))) / 3.;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        roots.push_back(-2. * sqrt(Q) * cos(theta) - an / 3.);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        roots.push_back(-2. * sqrt(Q) * cosXpm2PI3(theta, 1.) - an / 3.);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        roots.push_back(-2. * sqrt(Q) * cosXpm2PI3(theta, -1.) - an / 3.);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> A = -<a class="code" href="Math_8h.html#ae9bf9ca2a51a3c7bbcd32f3d29930684">sign</a>(R) * cbrt(abs(R) + sqrt(<a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(R) - <a class="code" href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a>(Q)));</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordtype">double</span> B;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span> (A == 0.)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            B = 0.;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            B = Q / A;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> x = A + B - an / 3.;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        roots.push_back(x);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        roots.push_back(x);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        roots.push_back(x);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Solutions of &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; x^3 + &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; x^2 + &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot; x + &quot;</span> &lt;&lt; d &lt;&lt; <span class="stringliteral">&quot;:&quot;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;             &lt;&lt; endl;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; roots.size(); i++)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; roots[i]</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;, test = &quot;</span> &lt;&lt; a * <a class="code" href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a>(roots[i]) + b * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(roots[i]) + c * roots[i] + d &lt;&lt; endl;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        cout &lt;&lt; endl;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="Math_8h.html#a0f997820a313ec0c77d142a733c34940">  116</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="Math_8h.html#a0f997820a313ec0c77d142a733c34940">solveQuartic</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> a, <span class="keyword">const</span> <span class="keywordtype">double</span> b, <span class="keyword">const</span> <span class="keywordtype">double</span> c, <span class="keyword">const</span> <span class="keywordtype">double</span> d, <span class="keyword">const</span> <span class="keywordtype">double</span> e,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                  std::vector&lt;double&gt;&amp; roots, <span class="keywordtype">bool</span> verbose) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (!a)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="Math_8h.html#aa7d60d1f5a82d685d084c70662bf3980">solveCubic</a>(b, c, d, e, roots, verbose);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (!b &amp;&amp; !c &amp;&amp; !d &amp;&amp; !e) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        roots.push_back(0.);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        roots.push_back(0.);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        roots.push_back(0.);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        roots.push_back(0.);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!b &amp;&amp; !d) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        std::vector&lt;double&gt; sq_sol;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a>(a, c, e, sq_sol, verbose);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; sq_sol.size(); ++i) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">if</span> (sq_sol[i] &lt; 0)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            roots.push_back(sqrt(sq_sol[i]));</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            roots.push_back(-sqrt(sq_sol[i]));</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> an = b / a;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> bn = c / a - (3. / 8.) * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(b / a);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> cn = <a class="code" href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a>(0.5 * b / a) - 0.5 * b * c / <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(a) + d / a;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> dn =</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                -3. * <a class="code" href="Math_8h.html#ab151e016c256610f46de3e9233280fb5">QU</a>(0.25 * b / a) + e / a - 0.25 * b * d / <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(a) + c * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(b / 4.) / <a class="code" href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a>(a);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        std::vector&lt;double&gt; res;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="Math_8h.html#aa7d60d1f5a82d685d084c70662bf3980">solveCubic</a>(1., 2. * bn, <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(bn) - 4. * dn, -<a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(cn), res, verbose);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordtype">short</span> pChoice = -1;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; res.size(); ++i) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">if</span> (res[i] &gt; 0) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                pChoice = i;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (pChoice &lt; 0) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;No real solution to &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; x^4 + &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; x^3 + &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot; x^2 + &quot;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                     &lt;&lt; d &lt;&lt; <span class="stringliteral">&quot; x + &quot;</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">&quot; (no positive root for the resolvent cubic).&quot;</span> &lt;&lt; endl</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                     &lt;&lt; endl;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> p = sqrt(res[pChoice]);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a>(p, <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(p), 0.5 * (p * (bn + res[pChoice]) - cn), roots, verbose);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a>(p, -<a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(p), 0.5 * (p * (bn + res[pChoice]) + cn), roots, verbose);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; roots.size(); ++i)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            roots[i] -= an / 4.;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">size_t</span> nRoots = roots.size();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span> (nRoots) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Solutions of &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; x^4 + &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; x^3 + &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot; x^2 + &quot;</span> &lt;&lt; d</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; x + &quot;</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; nRoots; i++)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; roots[i] &lt;&lt; <span class="stringliteral">&quot;, test = &quot;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                     &lt;&lt; a * <a class="code" href="Math_8h.html#ab151e016c256610f46de3e9233280fb5">QU</a>(roots[i]) + b * <a class="code" href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a>(roots[i]) + c * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(roots[i]) + d * roots[i] + e</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                     &lt;&lt; endl;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            cout &lt;&lt; endl;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;No real solution to &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; x^4 + &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; x^3 + &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot; x^2 + &quot;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                 &lt;&lt; d &lt;&lt; <span class="stringliteral">&quot; x + &quot;</span> &lt;&lt; e &lt;&lt; endl</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                 &lt;&lt; endl;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> nRoots &gt; 0;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="Math_8h.html#a032d8963941cf3f2e11db530c5386f4e">  191</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="Math_8h.html#a032d8963941cf3f2e11db530c5386f4e">solve2Quads</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> a20, <span class="keyword">const</span> <span class="keywordtype">double</span> a02, <span class="keyword">const</span> <span class="keywordtype">double</span> a11, <span class="keyword">const</span> <span class="keywordtype">double</span> a10,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> a01, <span class="keyword">const</span> <span class="keywordtype">double</span> a00, <span class="keyword">const</span> <span class="keywordtype">double</span> b20, <span class="keyword">const</span> <span class="keywordtype">double</span> b02,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> b11, <span class="keyword">const</span> <span class="keywordtype">double</span> b10, <span class="keyword">const</span> <span class="keywordtype">double</span> b01, <span class="keyword">const</span> <span class="keywordtype">double</span> b00,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                 std::vector&lt;double&gt;&amp; E1, std::vector&lt;double&gt;&amp; E2, <span class="keywordtype">bool</span> verbose) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// The procedure used in this function relies on a20 != 0 or b20 != 0</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (a20 == 0. &amp;&amp; b20 == 0.) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (a02 != 0. || b02 != 0.) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="comment">// Swapping E1 &lt;-&gt; E2 should suffice!</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="Math_8h.html#a032d8963941cf3f2e11db530c5386f4e">solve2Quads</a>(a02, a20, a11, a01, a10, a00, b02, b20, b11, b01, b10, b00, E2, E1,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                               verbose);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="Math_8h.html#a5b10f551ee6022d7d32975f9b207ad65">solve2QuadsDeg</a>(a11, a10, a01, a00, b11, b10, b01, b00, E1, E2, verbose);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = b20 * a02 - a20 * b02;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> beta = b20 * a11 - a20 * b11;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> gamma = b20 * a10 - a20 * b10;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> delta = b20 * a01 - a20 * b01;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> omega = b20 * a00 - a20 * b00;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> a = a20 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(alpha) + a02 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(beta) - a11 * alpha * beta;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> b = 2. * a20 * alpha * delta - a11 * (alpha * gamma + delta * beta) -</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                     a10 * alpha * beta + 2. * a02 * beta * gamma + a01 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(beta);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> c = a20 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(delta) + 2. * a20 * alpha * omega -</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                     a11 * (delta * gamma + omega * beta) - a10 * (alpha * gamma + delta * beta) +</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                     a02 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(gamma) + 2. * a01 * beta * gamma + a00 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(beta);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> d = 2. * a20 * delta * omega - a11 * omega * gamma -</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                     a10 * (delta * gamma + omega * beta) + a01 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(gamma) +</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                     2. * a00 * beta * gamma;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> e = a20 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(omega) - a10 * omega * gamma + a00 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(gamma);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="Math_8h.html#a0f997820a313ec0c77d142a733c34940">solveQuartic</a>(a, b, c, d, e, E2, verbose);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; E2.size(); ++i) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> e2 = E2[i];</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (beta * e2 + gamma != 0.) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="comment">// Everything OK</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> e1 = -(alpha * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(e2) + delta * e2 + omega) / (beta * e2 + gamma);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            E1.push_back(e1);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (alpha * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(e2) + delta * e2 + omega == 0.) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="comment">// Up to two solutions for e1</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            std::vector&lt;double&gt; e1;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a>(a20, a11 * e2 + a10, a02 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(e2) + a01 * e2 + a00, e1, verbose)) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a>(b20, b11 * e2 + b10, b02 * <a class="code" href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(e2) + b01 * e2 + b00, e1,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                    verbose)) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    cout &lt;&lt; <span class="stringliteral">&quot;Error in solve2Quads: there should be at least one solution for e1!&quot;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                         &lt;&lt; endl;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    E1.clear();</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    E2.clear();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="comment">// We have either a double, or two roots for e1</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="comment">// In this case, e2 must be twice degenerate!</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="comment">// Since in E2 degenerate roots are grouped, E2[i+1] shoud exist and be equal to e2</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="comment">// We then go straight for i+2.</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="keywordflow">if</span> (i &lt; E2.size() - 1) {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    <span class="keywordflow">if</span> (e2 != E2[i + 1]) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                        cout &lt;&lt; <span class="stringliteral">&quot;Error in solve2Quads: if there are two solutions for e1, e2 &quot;</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                <span class="stringliteral">&quot;should be degenerate!&quot;</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                             &lt;&lt; endl;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                        E1.clear();</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        E2.clear();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    E1.push_back(e1[0]);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    E1.push_back(e1[1]);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    ++i;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    cout &lt;&lt; <span class="stringliteral">&quot;Error in solve2Quads: if there are two solutions for e1, e2 should be &quot;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                            <span class="stringliteral">&quot;degenerate!&quot;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                         &lt;&lt; endl;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    E1.clear();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    E2.clear();</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">// There is no solution given this e2</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            E2.erase(E2.begin() + i);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            --i;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="Math_8h.html#a5b10f551ee6022d7d32975f9b207ad65">solve2QuadsDeg</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> a11, <span class="keyword">const</span> <span class="keywordtype">double</span> a10, <span class="keyword">const</span> <span class="keywordtype">double</span> a01, <span class="keyword">const</span> <span class="keywordtype">double</span> a00,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> b11, <span class="keyword">const</span> <span class="keywordtype">double</span> b10, <span class="keyword">const</span> <span class="keywordtype">double</span> b01, <span class="keyword">const</span> <span class="keywordtype">double</span> b00,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    vector&lt;double&gt;&amp; E1, vector&lt;double&gt;&amp; E2, <span class="keywordtype">bool</span> verbose) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (a11 == 0. &amp;&amp; b11 == 0.)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="Math_8h.html#a4ae0b6426765b6a90a644a14247ac080">solve2Linear</a>(a10, a01, a00, b10, b01, b00, E1, E2, verbose);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">bool</span> result = <a class="code" href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a>(a11 * (b11 * a10 - a11 * b10),</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                 a01 * (b11 * a10 - a11 * b10) - a01 * (b11 * a01 - a11 * b01) +</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                         a11 * (b11 * a00 - a11 * b00),</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                 a01 * (b11 * a00 - a11 * b00), E1, verbose);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (!result) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;No solution to the system:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; a11 &lt;&lt; <span class="stringliteral">&quot;*E1*E2 + &quot;</span> &lt;&lt; a10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; a01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; a00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                 &lt;&lt; endl;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; b11 &lt;&lt; <span class="stringliteral">&quot;*E1*E2 + &quot;</span> &lt;&lt; b10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; b01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; b00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                 &lt;&lt; endl;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            cout &lt;&lt; endl;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; E1.size(); ++i) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordtype">double</span> denom = a11 * E1[i] + a01;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">if</span> (denom != 0) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            E2.push_back(-(a10 * E1[i] + a00) / denom);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            denom = b11 * a01 - a11 * b01;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">if</span> (denom != 0.) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                E2.push_back(-((b11 * a10 - a11 * b10) * E1[i] + b11 * a00 - a11 * b00) / denom);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                denom = b11 * E1[i] + b01;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="keywordflow">if</span> (denom != 0.) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    E2.push_back(-(b10 * E1[i] + b00) / denom);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    E1.erase(E1.begin() + i);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    --i;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Solutions to the system:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; a11 &lt;&lt; <span class="stringliteral">&quot;*E1*E2 + &quot;</span> &lt;&lt; a10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; a01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; a00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;             &lt;&lt; endl;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; b11 &lt;&lt; <span class="stringliteral">&quot;*E1*E2 + &quot;</span> &lt;&lt; b10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; b01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; b00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;             &lt;&lt; endl;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i = 0; i &lt; E1.size(); ++i)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;  E1 = &quot;</span> &lt;&lt; E1[i] &lt;&lt; <span class="stringliteral">&quot;, E2 = &quot;</span> &lt;&lt; E2[i] &lt;&lt; endl;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        cout &lt;&lt; endl;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">return</span> E1.size();</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="Math_8h.html#a4ae0b6426765b6a90a644a14247ac080">  356</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="Math_8h.html#a4ae0b6426765b6a90a644a14247ac080">solve2Linear</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> a10, <span class="keyword">const</span> <span class="keywordtype">double</span> a01, <span class="keyword">const</span> <span class="keywordtype">double</span> a00, <span class="keyword">const</span> <span class="keywordtype">double</span> b10,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> b01, <span class="keyword">const</span> <span class="keywordtype">double</span> b00, std::vector&lt;double&gt;&amp; E1,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                  std::vector&lt;double&gt;&amp; E2, <span class="keywordtype">bool</span> verbose) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> det = a10 * b01 - b10 * a01;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (det == 0.) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span> (a00 != 0. || b00 != 0.) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;No solution to the system:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; a10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; a01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; a00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; b10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; b01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; b00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                cout &lt;&lt; endl;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Error in solve2Linear: indeterminate system:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; a10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; a01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; a00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; b10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; b01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; b00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            cout &lt;&lt; endl;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> e2 = (b10 * a00 - a10 * b00) / det;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    E2.push_back(e2);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">double</span> e1;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (a10 == 0.)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        e1 = -(b00 + b01 * e2) / b10;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        e1 = -(a00 + a01 * e2) / a10;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    E1.push_back(e1);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Solution to the system:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; a10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; a01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; a00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; b10 &lt;&lt; <span class="stringliteral">&quot;*E1 + &quot;</span> &lt;&lt; b01 &lt;&lt; <span class="stringliteral">&quot;*E2 + &quot;</span> &lt;&lt; b00 &lt;&lt; <span class="stringliteral">&quot; = 0&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  E1 = &quot;</span> &lt;&lt; e1 &lt;&lt; <span class="stringliteral">&quot;, E2 = &quot;</span> &lt;&lt; e2 &lt;&lt; endl &lt;&lt; endl;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="Math_8h.html#ae19ca2bf646e868bee58526c8489251f">  399</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="Math_8h.html#ae19ca2bf646e868bee58526c8489251f">BreitWigner</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> s, <span class="keyword">const</span> <span class="keywordtype">double</span> m, <span class="keyword">const</span> <span class="keywordtype">double</span> g) {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">double</span> k = m * g;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> k / (std::pow(s - m * m, 2.) + std::pow(m * g, 2.));</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="ttc" id="Math_8h_html_a0f997820a313ec0c77d142a733c34940"><div class="ttname"><a href="Math_8h.html#a0f997820a313ec0c77d142a733c34940">solveQuartic</a></div><div class="ttdeci">bool solveQuartic(const double a, const double b, const double c, const double d, const double e, std::vector&lt; double &gt; &amp;roots, bool verbose=false)</div><div class="ttdoc">Finds the real solutions to . </div><div class="ttdef"><b>Definition:</b> <a href="Math_8cc_source.html#l00116">Math.cc:116</a></div></div>
<div class="ttc" id="Math_8h_html"><div class="ttname"><a href="Math_8h.html">Math.h</a></div><div class="ttdoc">Mathematical functions. </div></div>
<div class="ttc" id="Math_8h_html_afd0e0488c42523a0591b7cd0bf2e2799"><div class="ttname"><a href="Math_8h.html#afd0e0488c42523a0591b7cd0bf2e2799">solveQuadratic</a></div><div class="ttdeci">bool solveQuadratic(const double a, const double b, const double c, std::vector&lt; double &gt; &amp;roots, bool verbose=false)</div><div class="ttdoc">Finds the real solutions to . </div><div class="ttdef"><b>Definition:</b> <a href="Math_8cc_source.html#l00025">Math.cc:25</a></div></div>
<div class="ttc" id="Math_8h_html_ab151e016c256610f46de3e9233280fb5"><div class="ttname"><a href="Math_8h.html#ab151e016c256610f46de3e9233280fb5">QU</a></div><div class="ttdeci">#define QU(x)</div><div class="ttdoc">Compute . </div><div class="ttdef"><b>Definition:</b> <a href="Math_8h_source.html#l00029">Math.h:29</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="InputTag__fwd_8h_source.html#l00118">InputTag_fwd.h:118</a></div></div>
<div class="ttc" id="Math_8h_html_ae9bf9ca2a51a3c7bbcd32f3d29930684"><div class="ttname"><a href="Math_8h.html#ae9bf9ca2a51a3c7bbcd32f3d29930684">sign</a></div><div class="ttdeci">T sign(const T &amp;x)</div><div class="ttdoc">Sign function. </div><div class="ttdef"><b>Definition:</b> <a href="Math_8h_source.html#l00041">Math.h:41</a></div></div>
<div class="ttc" id="Math_8h_html_a4ae0b6426765b6a90a644a14247ac080"><div class="ttname"><a href="Math_8h.html#a4ae0b6426765b6a90a644a14247ac080">solve2Linear</a></div><div class="ttdeci">bool solve2Linear(const double a10, const double a01, const double a00, const double b10, const double b01, const double b00, std::vector&lt; double &gt; &amp;E1, std::vector&lt; double &gt; &amp;E2, bool verbose=false)</div><div class="ttdoc">Solve a system of two linear equations. </div><div class="ttdef"><b>Definition:</b> <a href="Math_8cc_source.html#l00356">Math.cc:356</a></div></div>
<div class="ttc" id="Math_8h_html_ac3644f84794a8bfdacf39c4b2c2495fc"><div class="ttname"><a href="Math_8h.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a></div><div class="ttdeci">#define SQ(x)</div><div class="ttdoc">Compute . </div><div class="ttdef"><b>Definition:</b> <a href="Math_8h_source.html#l00025">Math.h:25</a></div></div>
<div class="ttc" id="Math_8h_html_ae19ca2bf646e868bee58526c8489251f"><div class="ttname"><a href="Math_8h.html#ae19ca2bf646e868bee58526c8489251f">BreitWigner</a></div><div class="ttdeci">double BreitWigner(const double s, const double m, const double g)</div><div class="ttdoc">A relativist Breit-Wigner distribution. </div><div class="ttdef"><b>Definition:</b> <a href="Math_8cc_source.html#l00399">Math.cc:399</a></div></div>
<div class="ttc" id="Math_8h_html_a060b8b47ae64b35f239a34b426831292"><div class="ttname"><a href="Math_8h.html#a060b8b47ae64b35f239a34b426831292">CB</a></div><div class="ttdeci">#define CB(x)</div><div class="ttdoc">Compute . </div><div class="ttdef"><b>Definition:</b> <a href="Math_8h_source.html#l00027">Math.h:27</a></div></div>
<div class="ttc" id="Math_8h_html_a5b10f551ee6022d7d32975f9b207ad65"><div class="ttname"><a href="Math_8h.html#a5b10f551ee6022d7d32975f9b207ad65">solve2QuadsDeg</a></div><div class="ttdeci">bool solve2QuadsDeg(const double a11, const double a10, const double a01, const double a00, const double b11, const double b10, const double b01, const double b00, std::vector&lt; double &gt; &amp;E1, std::vector&lt; double &gt; &amp;E2, bool verbose=false)</div><div class="ttdoc">Solve a system of two degenerated quadratic equations. </div></div>
<div class="ttc" id="Math_8h_html_a032d8963941cf3f2e11db530c5386f4e"><div class="ttname"><a href="Math_8h.html#a032d8963941cf3f2e11db530c5386f4e">solve2Quads</a></div><div class="ttdeci">bool solve2Quads(const double a20, const double a02, const double a11, const double a10, const double a01, const double a00, const double b20, const double b02, const double b11, const double b10, const double b01, const double b00, std::vector&lt; double &gt; &amp;E1, std::vector&lt; double &gt; &amp;E2, bool verbose=false)</div><div class="ttdoc">Solve a system of two quadratic equations. </div><div class="ttdef"><b>Definition:</b> <a href="Math_8cc_source.html#l00191">Math.cc:191</a></div></div>
<div class="ttc" id="Math_8h_html_aa7d60d1f5a82d685d084c70662bf3980"><div class="ttname"><a href="Math_8h.html#aa7d60d1f5a82d685d084c70662bf3980">solveCubic</a></div><div class="ttdeci">bool solveCubic(const double a, const double b, const double c, const double d, std::vector&lt; double &gt; &amp;roots, bool verbose=false)</div><div class="ttdoc">Finds the real solutions to . </div><div class="ttdef"><b>Definition:</b> <a href="Math_8cc_source.html#l00068">Math.cc:68</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
<script type="text/javascript" src="doxy-boot.js"></script>
</body>
</html>
